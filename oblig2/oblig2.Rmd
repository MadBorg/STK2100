---
title: "oblig2"
author: "Sanders"
date: "4/7/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Problem 1.

### Reading dataset

```{r}
df <- read.csv("leukemia_big.csv",
               header = T,
               sep = ","
               )
N_gene_expressions = 7128
N_patiants = 72

ALL_patients = grepl("ALL", names(df))
AML_patients = grepl("AML", names(df))
```

###  a)

```{r}
library(pls)

PC_analysis = prcomp(t(df), center = T, scale = T, rank. = 2)
plot(
  PC_analysis$x, col=c("blue", "red"), main="lukemia", xlab="PC1", ylab = "PC2", pch=1
)
X = PC_analysis$x

points(X[ALL_patients,1], X[ALL_patients, 2], col = "4", pch = 19)
points(X[AML_patients,1], X[AML_patients, 2], col = "2", pch = 19)
legend("topleft", legend = c("ALL", "AML"), col = c(2, 4), pch = c(19, 19))

```

### b)

```{r}
library(glmnet)
target_df = df <- read.csv("response_train.csv",
               header = T,
               sep = ","
               )

mod.Lasso = glmnet(x = as.matrix(df), y = as.matrix(target_df), alfa = 1, standardize = T)
lambda.l.a = cv.glmnet(x =as.matrix(df), y = as.matrix(target_df), alfa = 1, standardize = T)

```

