---
title: "oblig2"
author: "Sanders"
date: "4/7/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Problem 1.

### Reading dataset

```{r}
df <- read.csv("http://web.stanford.edu/~hastie/CASI_files/DATA/leukemia_big.csv",
               header = T,
               sep = ","
               )
N_gene_expressions = 7128
N_patiants = 72

ALL_patients = grepl("ALL", names(df))
AML_patients = grepl("AML", names(df))
```

###  a)

```{r}
library(pls)

PC_analysis = prcomp(t(df), center = T, scale = T, rank. = 2)
plot(
  PC_analysis$x, col=c("blue", "red"), main="lukemia", xlab="PC1", ylab = "PC2", pch=1
)
X = PC_analysis$x

points(X[ALL_patients,1], X[ALL_patients, 2], col = "4", pch = 19)
points(X[AML_patients,1], X[AML_patients, 2], col = "2", pch = 19)
legend("topleft", legend = c("ALL", "AML"), col = c(2, 4), pch = c(19, 19))

```

### b)

```{r}
library(glmnet)
target_df <- read.csv("https://www.uio.no/studier/emner/matnat/math/STK2100/v20/eksamen/response_train.csv",
               header = T,
               sep = ","
               )

mod.Lasso = glmnet(x = t(df), y = target_df[,2], alfa = 1, standardize = T)
lambda.l.a = cv.glmnet(x =t(df), y = target_df[,2], alfa = 1, standardize = T, nfolds = 3)
plot(mod.Lasso)
plot(lambda.l.a)

 ```

